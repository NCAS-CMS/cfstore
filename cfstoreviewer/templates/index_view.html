<!DOCTYPE html>
<html>
<head>
  {% load static %}

  <link rel="stylesheet" href="{% static '/cfstore.css' %}">
</head>
<html>
  <h2>Collections</h2>

  {%for collection in collections %}
  <button type="button" class="collapsible">{{collection.name}}</button>
  <div class="collection-block">
  

  <button type="button" class="collapsible">Variables
</button>
  <div class="collapsible-content">
    <form action="/cfstoreviewer/viewcollections/search/" method="post">
      {% csrf_token %}
      {{variable_search_form}}
    </form>  
    <table id="collapsibletable">

      {% for var,count in collection|getuniquevariables %}
      <tr>
        <td><a href="/cfstoreviewer/viewcollections/variables/{{var}}"> <p class="variable">{{var}} ({{count}} unique variation(s))</p></a></td>
      </tr>
      {% endfor %}
    </table>
  </div>



  </div>
  {% endfor %}

  <div class="browser">
  {% for propkey in collection|getallvariableproperties %}
    <button type="button" id="{{prop}}" class="collapsiblebrowser">{{propkey|displayproperty}} </button>
    <div class="collapsiblebrowser-content"> 
      <table id="collapsibletable">
        {% for property in propkey|getpropertyvalues %}
            <tr>
              <td> 
                <p class="property">
                  <input type="checkbox" id="{{property}}"> {{property}} 
                </p>
              </td>
            </tr>
        {% endfor %}
      </table>
    </div>
  {% endfor %}
  </div>


<script>
  var coll = document.getElementsByClassName("collapsible");
  var i;
  
  for (i = 0; i < coll.length; i++) {
    coll[i].addEventListener("click", function() {
      this.classList.toggle("active");
      var content = this.nextElementSibling;
      if (content.style.display === "block") {
        content.style.display = "none";
      } else {
        content.style.display = "block";
      }
    });
  }
  </script>

<script>
  var coll = document.getElementsByClassName("collapsible-content");
  var i;
  
  for (i = 0; i < coll.length; i++) {
    coll[i].addEventListener("click", function() {
      this.classList.toggle("active");
      var content = this.nextElementSibling;
      if (content.style.display === "block") {
        content.style.display = "none";
      } else {
        content.style.display = "block";
      }
    });
  }
  </script>

<script>
  var coll = document.getElementsByClassName("collapsiblebrowser");
  var i;
  
  for (i = 0; i < coll.length; i++) {
    coll[i].addEventListener("click", function() {
      this.classList.toggle("active");
      var content = this.nextElementSibling;
      if (content.style.display === "block") {
        content.style.display = "none";
      } else {
        content.style.display = "block";
      }
    });
  }
  </script>

<script>
  var coll = document.getElementsByClassName("collapsible-browser-content");
  var i;
  
  for (i = 0; i < coll.length; i++) {
    coll[i].addEventListener("click", function() {
      this.classList.toggle("active");
      var content = this.nextElementSibling;
      if (content.style.display === "block") {
        content.style.display = "none";
      } else {
        content.style.display = "block";
      }
    });
  }
  </script>
</body>
</html>